@page
@model ChartOfAccountsModel
@{
    ViewData["Title"] = "Chart of Accounts";
}

<h2>Chart of Accounts</h2>

<form method="post" asp-page-handler="Create">
    <div>
        <label>Account Name:</label>
        <input asp-for="Account.Name" />
    </div>
    <div>
        <label>Parent Account:</label>
        <select asp-for="Account.ParentId">
            <option value="">-- None --</option>
            @foreach (var acc in Model.Accounts)
            {
                <option value="@acc.Id">@acc.Name</option>
            }
        </select>
    </div>
    <div>
        <label>Account Type:</label>
        <input asp-for="Account.AccountType" />
    </div>
    <button type="submit">Create Account</button>
</form>

<hr />

<h3>Account List</h3>
<ul>
    @foreach (var acc in Model.Accounts.Where(a => a.ParentId == null))
    {
        <li>
            <b>@acc.Name</b> (@acc.AccountType)
            <ul>
                @foreach (var child in Model.Accounts.Where(c => c.ParentId == acc.Id))
                {
                    <li>@child.Name (@child.AccountType)</li>
                }
            </ul>
        </li>
    }
</ul>
